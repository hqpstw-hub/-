name: 4GTV Auto Parser
on:
  schedule:
    - cron: '0 */4 * * *' # 每 4 小時自動跑一次
  workflow_dispatch:      # 也可以手動按按鈕執行

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v3

      - name: Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.10'

      - name: Install dependencies
        run: |
          pip install yt-dlp

      - name: Parse 4GTV and YouTube
        run: |
          # 這裡跑原本在盒子上的解析邏輯，但用的是 GitHub 的強大性能
          # 假設你的原始清單叫 raw_list.txt，產出叫 cloud_tv.m3u
          # (具體解析腳本我等下幫你寫成一個單獨的 python 檔)
          python3 parser.py

      - name: Commit and Push
        run: |
          git config --local user.email "action@github.com"
          git config --local user.name "GitHub Action"
          git add cloud_tv.m3u
          git commit -m "Update TV List" || exit 0
          git push
